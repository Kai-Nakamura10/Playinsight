<%= form_with model: tactic, class: "space-y-8", data: { controller: "step-form" } do |f| %>
  <div class="h-2 w-full rounded-full bg-gray-200">
    <div class="h-2 rounded-full bg-blue-600 transition-all duration-300" data-step-form-target="progress"></div>
  </div>

  <div data-step-form-target="step" class="space-y-6">
    <div class="grid gap-6 md:grid-cols-2">
      <div class="md:col-span-2">
        <%= f.label :title, "タイトル", class: "block text-sm font-medium text-gray-700" %>
        <%= f.text_field :title, class: "mt-2 w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-blue-500 focus:ring focus:ring-blue-200" %>
      </div>

      <div>
        <%= f.label :slug, "スラッグ", class: "block text-sm font-medium text-gray-700" %>
        <%= f.text_field :slug, class: "mt-2 w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-blue-500 focus:ring focus:ring-blue-200" %>
      </div>

      <div>
        <%= f.label :trigger, "トリガー", class: "block text-sm font-medium text-gray-700" %>
        <%= f.text_field :trigger, class: "mt-2 w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-blue-500 focus:ring focus:ring-blue-200" %>
      </div>
    </div>

    <div class="flex justify-end gap-3">
      <button type="button" class="rounded-lg border border-gray-300 px-4 py-2 text-gray-600" data-step-form-target="prevButton" data-action="click->step-form#prev">前へ</button>
      <button type="button" class="rounded-lg bg-blue-600 px-4 py-2 text-white" data-step-form-target="nextButton" data-action="click->step-form#next">次へ</button>
    </div>
  </div>

  <div data-step-form-target="step" class="space-y-6 hidden">
    <div>
      <%= f.label :description, "説明", class: "block text-sm font-medium text-gray-700" %>
      <%= f.text_area :description, rows: 4, class: "mt-2 w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-blue-500 focus:ring focus:ring-blue-200" %>
    </div>

    <div class="flex justify-between gap-3">
      <button type="button" class="rounded-lg border border-gray-300 px-4 py-2 text-gray-600" data-step-form-target="prevButton" data-action="click->step-form#prev">前へ</button>
      <button type="button" class="rounded-lg bg-blue-600 px-4 py-2 text-white" data-step-form-target="nextButton" data-action="click->step-form#next">次へ</button>
    </div>
  </div>

  <div data-step-form-target="step" class="space-y-6 hidden">
    <div>
      <%= f.label :success_text, "成功条件（1行=1項目）", class: "block text-sm font-medium text-gray-700" %>
      <%= f.text_area :success_text,
            value: (tactic.success_text.presence || tactic.success_conditions.join("\n")),
            rows: 4, class: "mt-2 w-full rounded-lg border border-gray-300 px-4 py-2 font-mono focus:border-blue-500 focus:ring focus:ring-blue-200" %>
    </div>

    <div>
      <%= f.label :failure_text, "よくある失敗（1行=1項目）", class: "block text-sm font-medium text-gray-700" %>
      <%= f.text_area :failure_text,
            value: (tactic.failure_text.presence || tactic.common_failures.join("\n")),
            rows: 4, class: "mt-2 w-full rounded-lg border border-gray-300 px-4 py-2 font-mono focus:border-blue-500 focus:ring focus:ring-blue-200" %>
    </div>

    <div class="flex justify-between gap-3">
      <button type="button" class="rounded-lg border border-gray-300 px-4 py-2 text-gray-600" data-step-form-target="prevButton" data-action="click->step-form#prev">前へ</button>
      <button type="button" class="rounded-lg bg-blue-600 px-4 py-2 text-white" data-step-form-target="nextButton" data-action="click->step-form#next">次へ</button>
    </div>
  </div>

  <div data-step-form-target="step" class="space-y-6 hidden">
    <div>
      <%= f.label :counters_text, "カウンター（文字列でOK）", class: "block text-sm font-medium text-gray-700" %>
      <%= f.text_field :counters_text,
            value: (tactic.counters_text.presence || tactic.counters_string),
            class: "mt-2 w-full rounded-lg border border-gray-300 px-4 py-2 focus:border-blue-500 focus:ring focus:ring-blue-200" %>
    </div>

    <div class="flex flex-col gap-3 sm:flex-row sm:justify-between">
      <button type="button" class="rounded-lg border border-gray-300 px-4 py-2 text-gray-600" data-step-form-target="prevButton" data-action="click->step-form#prev">前へ</button>
      <%= f.submit "保存する", class: "inline-flex justify-center rounded-lg bg-blue-600 px-6 py-2 text-white font-medium hover:bg-blue-700" %>
    </div>
  </div>
<% end %>